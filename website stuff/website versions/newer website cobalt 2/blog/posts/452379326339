{"name":"Windows Wiped my Files Away","id":"452379326339","author":"Jack Anderson","date":"2023-01-08T01:14:58.723Z","tags":[],"description":"What did Windows do this time? I'm accusing it of deleting my Virtual Machine files.","body":"<p>Today's article is going to be a little bit different in an attempt to broaden the horizons of this 'journal', and just because I wanted to talk about this. As well, keep in mind that my conclusion is a hypothesis based on information I was able to gather, but is not necesarily exactly what happened. This is simply a short story about a mysterious case of missing files on my machine.</p>\n<p>Windows has a way of keeping me in its ecosystem. No matter how many times I've tried to leave, there's something keeping me there, be it games or some specialized software. I've had a Raspberry Pi for 4 years now, allowing me to gain lots of Linux experience in the command line, bleeding over to installing Linux on other computers for, at that time, the performance benefit and the thrill of brand new software experiences. Expanding the frontiers from Windows to another operating system for the first time is quite interesting.</p>\n<p>Later on as I became more interested in software development, sysadminning, servers and networking, Linux became even more enticing, with the wide customization possibilities, the deep industry support and adoption, and at its core, being open source. Many times in the past few years I've tried to transition to Linux, but I've never been able to actually delete my Windows partitions, because there's always something I need from Windows.</p>\n<p>My reasoning, backed up by a lot of information on the internet is, when I need it I'll have it. But how often do I need it? I've got the Adobe suite, which to my current knowledge, can be run in a virtual machine. But I'd need to passthrough my GPU to edit in Premiere, and it's an NVIDIA GPU. They don't always play too well with Linux. Take gaming as another example, some steam games can run through Steam's compatibility layer, others won't, and some refuse. And then there's games off of Steam. If they don't work, it's not like I can just virtualize a Windows machine, for 1. The GPU passthrough, and 2. Games banning play on Virtual Machines. It's a never ending circle. To be honest, I don't play a ton of games that don't support Linux, but also when comes an opportunity to play a game, I'd like to be able to. This was a very long intro, point being Windows has my trapped in a corner at the moment.</p>\n<h2>Hyper-V is my Server Hypervisor, for reasons</h2>\n<p>I like virtual machines and servers, as stated earlier. I've written a Discord bot, and I like to play around with new operating systems. I also happen to own Windows 10/11 Pro, and Hyper-V Manager is really my only viable use for it. Hyper-V has some issues of its own, lots of which seemed to have no clear path to a solution, until suddenly becoming solved. This is in addition to little troubleshooting support being available for open source projects and software used often in homelabs, because Hyper-V is not used itself very often in homelabs. I'd use Proxmox, but I have no intent to get a dedicated homelab system, and for many reasons I will not be installing it on my main computer. Safe to say Hyper-V, like it or not, is my only virtualization host to get the most of all the resources on my system, as well as still holding the virtualization server experience and feature set.</p>\n<h2>A wild use case spotted in the wild!</h2>\n<p>When it came time that me and some friends were interested in starting a Minecraft Java Edition survival multiplayer server, I jumped on the opportunity to play around with some new features like ssh tunneling, and of course, a real virtualization opportunity for my pretty stale Hyper-V management interface. On the topic of SSH tunneling, I was extremely excited to find out how easy it was to tunnel the Minecraft Server data to a VPS, greatly increasing my security at home, in not having to expose any ports on my router, as well as maintaining tolerable network latency for everyone. The issue was, that I had to leave my computer on in order for the server to stay online, but yes, that's how a server works, and I had no issue with that, except I had to train myself not to habitually go to the start menu at the end of a session of using my computer, and just turning off the monitors instead.</p>\n<p>A few times in the past week I'd received various Windows Update messages, all of which I just dismissed and went on with my day. This reminded me that Linux is way less invasive when it comes to updates, and due to the modular structure of the OS, many pieces can be upgraded without a restart. I didn't think too much about this though.</p>\n<p>Days went on, Minecraft progressed, got some complaints about performance, to which I replied explaining it's more than likely just an issue of my Internet Service Provider, something I unfortunately cannot fix. I gave the server adequate RAM, even wrote some bash scripts to ensure my SSH tunnel would stay running, and later a very similar script to make sure the Minecraft server itself would restart in the case that it had crashed, which had become a slight issue for still mostly unexplained reasons, keeping in mind though, the virtual machine itself never crashed, only the Minecraft executable.</p>\n<p>The week went on, bringing us to this morning (January 7), when the server was inaccessible. I wasn't home when notified, so I just expected to get home and have to restart the server jar. Simple enough, although somehow I didn't think about the fact that my script to keep the server online showed to work when I'd tested it. I also hadn't been to my computer since yesterday evening (January 6).</p>\n<p>To my surprise in getting home, the virtual machine was in Saved state, which confused me, because I'd disabled checkpoints, and hadn't shut down my computer for a few days. In trying to start the virtual machine again, I got various errors pertaining to a missing Virtual Hard Disks. This started getting unnerving, as that would mean all the progress was lost. The investigation to find out what had happened had begun.</p>\n<p>I started by checking the virtual machine settings, making sure it was looking for the right Virtual Hard Disks. It seemed to be, but in pressing Browse, the C:/ProgramData/Microsoft/Windows/Virtual Hard Disks folder was empty. This became more worrying, meaning the Virtual Hard Disk was more than likely completely lost, and I had absolutely no idea as to why. Just for good measure, I checked the Recycle Bin and found nothing.</p>\n<p>Scanning the Hyper-V Manager list and different virtual machine statuses, I was confused to find out that my Devbot virtual machine was running fine. This lead me to beleive that Hyper V was possibly searching the wrong folder, but after a quick search I came to conclusion that creating a virtual machine through Quick Create and New must have different default Virtual Hard Disk locations. After switching through disks in the C:/Users/Public/Documents/Hyper-V/Virtual Hard Disks folder anyways, none of them contained the lost files. By this time, I'd accepted the unfortunate truth that the files were lost, but I still wanted to find out why, so I headed to Event Viewer.</p>\n<p>At first glance, all was fine in the System tab, with some typical Errors and Warnings which I checked and had no relation to the events, due to the process names and descriptions. After skimming a few categories, there were thousands of Information tagged logs, which I did not check. The path to a conclusion was getting harder and harder to see. As a next step, I asked some server memebers the last time they'd logged on, which was no later than 11:40pm. I then sorted the System logs by date and scrolled to to the bottom, where the earliest messages would be. Confusingly, the first log was at 3:32 AM this morning, which did not make sense to me at first, then I had my theory, and a frustrating one at that. A quick check of the log Source was enough: The first log of the day was a Kernel-Boot log. And more that followed, then some other startup logs which I started to check for confirmation. My computer had rebooted without my input, and there could be only one answer: Windows Update. The one bane of my computer's existance as a server, the reason I refused to accept my always-on machine as a viable server solution.</p>\n<p>I'd received more than one update confirmation notice in the past week, all of which I likely pressed Maybe Later to dismiss. But over time, Windows gets more forceful, until the one option becomes to update out of active hours. The only option to dismiss the dialog. I confirmed in Windows Update settings that my active hours are from 7:00am to 1:00am, so this was an easy confirmation. A quick check of Task Manager further confirms this, with my CPU uptime at 13:57 hours at the time of writing (5:31 PM). The only thing left to diagnose was the reasoning to the missing files, and there are many possibilities, but my best guess is Windows failed to properly save the machine states, the Hard Disks became corrupted, and were deleted upon rebooting. Even if that wasn't an accurate assumption, all that's left is to say I run Windows Insider Builds. That's enough to explain any weird behaviour even if the above isn't fully accurate. Some would go as far as to blame it on Windows as a whole, I'll give them the benefit of the doubt.</p>\n<p>In conclusion, Windows is frustrating. Windows Update only lived up to the criticism this time, and I learned of some real downsides to running my computer as a virtual machine host. This also might finally convince me that making backups is a good idea, because embarassingly enough, I can't say this is the first occurance during which I've lost—and failed to recover—some fairly important data.</p>\n<br>","published":true}